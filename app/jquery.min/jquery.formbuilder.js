(function(a){a.fn.formbuilder=function(q){var d=a.extend({save_url:false,load_url:false,control_box_target:false,useJson:true,serialize_prefix:"frmb",options_wrap_class:"options-wrap",messages:{save:"Save",add_new_field:"Add New Field...",text:"Text Field",title:"Title",paragraph:"Paragraph",checkboxes:"Checkboxes",radio:"Radio",select:"Select List",text_field:"Text Field",label:"Label",paragraph_field:"Paragraph Field",select_options:"Select Options",add:"Add",checkbox_group:"Checkbox Group",remove_message:"Are you sure you want to remove this element?",
remove:"X",radio_group:"Radio Group",selections_message:"Allow Multiple Selections",hide:"Hide",required:"Required",show:"Show"}},q),l="frmb-"+a("ul[id^=frmb-]").length++;return this.each(function(){var h=a(this).append('<ul id="'+l+'" class="frmb"></ul>').find("ul"),b="",s="",j=1,k;a(h).addClass(l);(function(e){var c="",f="",g="",m=l+"-control-box",t=l+"-save-button";c+='<option value="0">'+d.messages.add_new_field+"</option>";c+='<option value="input_text">'+d.messages.text+"</option>";c+='<option value="textarea">'+
d.messages.paragraph+"</option>";c+='<option value="checkbox">'+d.messages.checkboxes+"</option>";c+='<option value="radio">'+d.messages.radio+"</option>";c+='<option value="select">'+d.messages.select+"</option>";f='<select id="'+m+'" class="frmb-control">'+c+"</select>";g='<input type="submit" id="'+t+'" class="frmb-submit" value="'+d.messages.save+'"/>';e?a(e).append(f):a(h).before(f);a(h).after(g);a("#"+t).click(function(){a("#schema").attr("value",JSON.stringify(a(h).serializeFormList()));a("#form").submit();
return true});a("#"+m).change(function(){u(a(this).val());a(this).val(0).blur();a("body").animate({scrollTop:a("#frm-"+(j-1)+"-item").offset().top},500);return false})})(d.control_box_target);var u=function(e,c,f,g){b="";s=e;if(typeof c==="undefined")c="";switch(e){case "input_text":v(c,f,g);break;case "textarea":w(c,f,g);break;case "checkbox":x(c,f,g);break;case "radio":y(c,f,g);break;case "select":z(c,f,g);break}},v=function(e,c,f){e="";if(typeof c==="object")e=c[0];b+="<label>"+d.messages.label+
"</label>";b+='<input class="fld-label" id="label-'+j+'" type="text" value="'+unescape(e)+'" />';k="";n(d.messages.text,b,f,k)},w=function(e,c,f){e="";if(typeof c==="object")e=c[0];b+="<label>"+d.messages.label+"</label>";b+='<input type="text" value="'+unescape(e)+'" />';k="";n(d.messages.paragraph_field,b,f,k)},x=function(e,c,f){var g="";if(typeof c==="object")g=c[0];b+='<div class="chk_group">';b+='<div class="frm-fld"><label>'+d.messages.label+"</label>";b+='<input type="text" name="label" value="'+
unescape(g)+'" /></div>';b+='<div class="false-label">'+d.messages.select_options+"</div>";b+='<div class="fields '+d.options_wrap_class+'">';if(typeof e==="object")for(i=0;i<e.length;i++)b+=o(e[i]);else b+=o("");b+='<div class="add-area"><a href="#" class="add add_ck">'+d.messages.add+"</a></div>";b+="</div>";b+="</div>";k="";n(d.messages.checkbox_group,b,f,k)},o=function(e){var c=false,f="";if(typeof e==="object"){f=e[0];c=e[1]==="false"?false:true}b="";b+="<div>";b+='<input type="checkbox"'+(c?
' checked="checked"':"")+" />";b+='<input type="text" value="'+unescape(f)+'" />';b+='<a href="#" class="remove" title="'+d.messages.remove_message+'">'+d.messages.remove+"</a>";b+="</div>";return b},y=function(e,c,f){var g="";if(typeof c==="object")g=c[0];b+='<div class="rd_group">';b+='<div class="frm-fld"><label>'+d.messages.label+"</label>";b+='<input type="text" name="label" value="'+unescape(g)+'" /></div>';b+='<div class="false-label">'+d.messages.select_options+"</div>";b+='<div class="fields">';
if(typeof e==="object")for(i=0;i<e.length;i++)b+=p(e[i],"frm-"+j+"-fld");else b+=p("","frm-"+j+"-fld");b+='<div class="add-area"><a href="#" class="add add_rd">'+d.messages.add+"</a></div>";b+="</div>";b+="</div>";k="";n(d.messages.radio_group,b,f,k)},p=function(e,c){var f=false,g="";if(typeof e==="object"){g=e[0];f=e[1]==="false"?false:true}b="";b+="<div>";b+='<input type="radio"'+(f?' checked="checked"':"")+' name="radio_'+c+'" />';b+='<input type="text" value="'+unescape(g)+'" />';b+='<a href="#" class="remove" title="'+
d.messages.remove_message+'">'+d.messages.remove+"</a>";b+="</div>";return b},z=function(e,c,f){var g=false,m="";if(typeof c==="object"){m=c[0];g=c[1]==="true"?true:false}b+='<div class="opt_group">';b+='<div class="frm-fld"><label>'+d.messages.label+"</label>";b+='<input type="text" name="label" value="'+unescape(m)+'" /></div>';b+="";b+='<div class="false-label">'+d.messages.select_options+"</div>";b+='<div class="fields">';b+='<input type="checkbox" name="multiple"'+(g?'checked="checked"':"")+
">";b+='<label class="auto">'+d.messages.selections_message+"</label>";if(typeof e==="object")for(i=0;i<e.length;i++)b+=r(e[i],g);else b+=r("",g);b+='<div class="add-area"><a href="#" class="add add_opt">'+d.messages.add+"</a></div>";b+="</div>";b+="</div>";k="";n(d.messages.select,b,f,k)},r=function(e,c){return c?o(e):p(e)},n=function(e,c,f){if(f)f=f===true?true:false;c="";c+='<li id="frm-'+j+'-item" class="'+s+'">';c+='<div class="legend">';c+='<a id="frm-'+j+'" class="toggle-form" href="#">'+d.messages.hide+
"</a> ";c+='<strong id="txt-label-'+j+'">'+e+"</strong></div>";c+='<div id="frm-'+j+'-fld" class="frm-holder">';c+='<div class="frm-elements">';c+=b;c+='<div class="frm-fld frm-fld-req"><label for="required-'+j+'">'+d.messages.required+"</label>";c+='<input class="required" type="checkbox" value="1" name="required-'+j+'" id="required-'+j+'"'+(f?' checked="checked"':"")+" /></div>";c+='<a id="del_'+j+'" class="del-button delete-confirm" href="#" title="'+d.messages.remove_message+'"><span>Delete</span></a>';
c+="</div>";c+="</div>";c+="</li>";a(h).append(c);a("#frm-"+j+"-item").hide();a("#frm-"+j+"-item").animate({opacity:"show",height:"show"},"slow");j++};(function(e){var c="",f=false;a(e).each(function(){if(this.field_type==="input_text")f=[this.label];if(this.field_type==="textarea")f=[this.label];else if(this.field_type==="checkbox"){f=[this.label];c=[];a.each(this.values,function(){c.push([this.value,this.checked])})}else if(this.field_type==="radio"){f=[this.label];c=[];a.each(this.values,function(){c.push([this.value,
this.checked])})}else if(this.field_type==="select"){f=[this.label,this.multiple];c=[];a.each(this.values,function(){c.push([this.value,this.checked])})}else c=[this.values];u(this.field_type,c,f,this.required)})})(JSON.parse(a("#schema").attr("value")));a(".remove").live("click",function(){a(this).parent("div").animate({opacity:"hide",height:"hide",marginBottom:"0px"},"fast",function(){a(this).remove()});return false});a(".toggle-form").live("click",function(){var e=a(this).attr("id");if(a(this).html()===
d.messages.hide){a(this).removeClass("open").addClass("closed").html(d.messages.show);a("#"+e+"-fld").animate({opacity:"hide",height:"hide"},"slow");return false}if(a(this).html()===d.messages.show){a(this).removeClass("closed").addClass("open").html(d.messages.hide);a("#"+e+"-fld").animate({opacity:"show",height:"show"},"slow");return false}return false});a(".delete-confirm").live("click",function(){var e=a(this).attr("id").replace(/del_/,"");confirm(a(this).attr("label"))&&a("#frm-"+e+"-item").animate({opacity:"hide",
height:"hide",marginBottom:"0px"},"slow",function(){a(this).remove()});return false});a(".add_ck").live("click",function(){a(this).parent().before(o());return false});a(".add_opt").live("click",function(){a(this).parent().before(r("",false));return false});a(".add_rd").live("click",function(){a(this).parent().before(p(false,a(this).parents(".frm-holder").attr("id")));return false})})}})(jQuery);
(function(a){a.fn.serializeFormList=function(q){var d=a.extend({prepend:"ul",is_child:false,attributes:["class"],serialization_attributes:["field_type"]},q),l=[];if(!d.is_child)d.prepend="&"+d.prepend;this.each(function(){a(this).children().each(function(){for(att in d.attributes){var h={};h[d.serialization_attributes[att]]=escape(a(this).attr(d.attributes[att]));if(d.attributes[att]=="class"){h.required=a("#"+a(this).attr("id")+" input.required").attr("checked");switch(a(this).attr(d.attributes[att])){case "input_text":h.label=
escape(a("#"+a(this).attr("id")+" input[type=text]").val());break;case "textarea":h.label=escape(a("#"+a(this).attr("id")+" input[type=text]").val());break;case "checkbox":h.values=[];a("#"+a(this).attr("id")+" input[type=text]").each(function(){if(a(this).attr("name")=="label")h.label=escape(a(this).val());else{var b={};b.value=escape(a(this).val());b.checked=a(this).prev().attr("checked");h.values.push(b)}});break;case "radio":h.values=[];a("#"+a(this).attr("id")+" input[type=text]").each(function(){if(a(this).attr("name")==
"label")h.label=escape(a(this).val());else{var b={};b.value=escape(a(this).val());b.checked=a(this).prev().attr("checked");h.values.push(b)}});break;case "select":h.multiple=a("#"+a(this).attr("id")+" input[name=multiple]").attr("checked");a("#"+a(this).attr("id")+" input[type=text]").each(function(){if(a(this).attr("name")=="label")h.label=escape(a(this).val());else{var b={};b.value=escape(a(this).val());b.checked=a(this).prev().attr("checked");h.values.push(b)}});break}}l.push(h)}})});return l}})(jQuery);
