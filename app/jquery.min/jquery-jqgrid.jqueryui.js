(function(a){if(a.browser.msie&&a.browser.version==8)a.expr[":"].hidden=function(b){return b.offsetWidth===0||b.offsetHeight===0||b.style.display=="none"};a.jgrid._multiselect=false;if(a.ui)if(a.ui.multiselect){if(a.ui.multiselect.prototype._setSelected){var q=a.ui.multiselect.prototype._setSelected;a.ui.multiselect.prototype._setSelected=function(b,h){b=q.call(this,b,h);if(h&&this.selectedList){var c=this.element;this.selectedList.find("li").each(function(){a(this).data("optionLink")&&a(this).data("optionLink").remove().appendTo(c)})}return b}}if(a.ui.multiselect.prototype.destroy)a.ui.multiselect.prototype.destroy=
function(){this.element.show();this.container.remove();a.Widget===undefined?a.widget.prototype.destroy.apply(this,arguments):a.Widget.prototype.destroy.apply(this,arguments)};a.jgrid._multiselect=true}a.jgrid.extend({sortableColumns:function(b){return this.each(function(){function h(){c.p.disableClick=true}var c=this,g=c.p.id;g={tolerance:"pointer",axis:"x",scrollSensitivity:"1",items:">th:not(:has(#jqgh_"+g+"_cb,#jqgh_"+g+"_rn,#jqgh_"+g+"_subgrid),:hidden)",placeholder:{element:function(d){return a(document.createElement(d[0].nodeName)).addClass(d[0].className+
" ui-sortable-placeholder ui-state-highlight").removeClass("ui-sortable-helper")[0]},update:function(d,i){i.height(d.currentItem.innerHeight()-parseInt(d.currentItem.css("paddingTop")||0,10)-parseInt(d.currentItem.css("paddingBottom")||0,10));i.width(d.currentItem.innerWidth()-parseInt(d.currentItem.css("paddingLeft")||0,10)-parseInt(d.currentItem.css("paddingRight")||0,10))}},update:function(d,i){d=a(i.item).parent();d=a(">th",d);var j={},m=c.p.id+"_";a.each(c.p.colModel,function(l){j[this.name]=
l});var n=[];d.each(function(){var l=a(">div",this).get(0).id.replace(/^jqgh_/,"").replace(m,"");l in j&&n.push(j[l])});a(c).jqGrid("remapColumns",n,true,true);a.isFunction(c.p.sortable.update)&&c.p.sortable.update(n);setTimeout(function(){c.p.disableClick=false},50)}};if(c.p.sortable.options)a.extend(g,c.p.sortable.options);else if(a.isFunction(c.p.sortable))c.p.sortable={update:c.p.sortable};if(g.start){var e=g.start;g.start=function(d,i){h();e.call(this,d,i)}}else g.start=h;if(c.p.sortable.exclude)g.items+=
":not("+c.p.sortable.exclude+")";b.sortable(g).data("sortable").floating=true})},columnChooser:function(b){function h(f,k,p){if(k>=0){var o=f.slice(),r=o.splice(k,Math.max(f.length-k,k));if(k>f.length)k=f.length;o[k]=p;return o.concat(r)}}function c(f,k){if(f)if(typeof f=="string")a.fn[f]&&a.fn[f].apply(k,a.makeArray(arguments).slice(2));else a.isFunction(f)&&f.apply(k,a.makeArray(arguments).slice(2))}var g=this;if(!a("#colchooser_"+g[0].p.id).length){var e=a('<div id="colchooser_'+g[0].p.id+'" style="position:relative;overflow:hidden"><div><select multiple="multiple"></select></div></div>'),
d=a("select",e);b=a.extend({width:420,height:240,classname:null,done:function(f){f&&g.jqGrid("remapColumns",f,true)},msel:"multiselect",dlog:"dialog",dlog_opts:function(f){var k={};k[f.bSubmit]=function(){f.apply_perm();f.cleanup(false)};k[f.bCancel]=function(){f.cleanup(true)};return{buttons:k,close:function(){f.cleanup(true)},modal:f.modal?f.modal:false,resizable:f.resizable?f.resizable:true,width:f.width+20}},apply_perm:function(){a("option",d).each(function(){this.selected?g.jqGrid("showCol",
i[this.value].name):g.jqGrid("hideCol",i[this.value].name)});var f=[];a("option:selected",d).each(function(){f.push(parseInt(this.value,10))});a.each(f,function(){delete m[i[parseInt(this,10)].name]});a.each(m,function(){var k=parseInt(this,10);f=h(f,k,k)});b.done&&b.done.call(g,f)},cleanup:function(f){c(b.dlog,e,"destroy");c(b.msel,d,"destroy");e.remove();f&&b.done&&b.done.call(g)},msel_opts:{}},a.jgrid.col,b||{});if(a.ui)if(a.ui.multiselect)if(b.msel=="multiselect"){if(!a.jgrid._multiselect){alert("Multiselect plugin loaded after jqGrid. Please load the plugin before the jqGrid!");
return}b.msel_opts=a.extend(a.ui.multiselect.defaults,b.msel_opts)}b.caption&&e.attr("title",b.caption);if(b.classname){e.addClass(b.classname);d.addClass(b.classname)}if(b.width){a(">div",e).css({width:b.width,margin:"0 auto"});d.css("width",b.width)}if(b.height){a(">div",e).css("height",b.height);d.css("height",b.height-10)}var i=g.jqGrid("getGridParam","colModel"),j=g.jqGrid("getGridParam","colNames"),m={},n=[];d.empty();a.each(i,function(f){m[this.name]=f;if(this.hidedlg)this.hidden||n.push(f);
else d.append("<option value='"+f+"' "+(this.hidden?"":"selected='selected'")+">"+j[f]+"</option>")});var l=a.isFunction(b.dlog_opts)?b.dlog_opts.call(g,b):b.dlog_opts;c(b.dlog,e,l);l=a.isFunction(b.msel_opts)?b.msel_opts.call(g,b):b.msel_opts;c(b.msel,d,l)}},sortableRows:function(b){return this.each(function(){var h=this;if(h.grid)if(!h.p.treeGrid)if(a.fn.sortable){b=a.extend({cursor:"move",axis:"y",items:".jqgrow"},b||{});if(b.start&&a.isFunction(b.start)){b._start_=b.start;delete b.start}else b._start_=
false;if(b.update&&a.isFunction(b.update)){b._update_=b.update;delete b.update}else b._update_=false;b.start=function(c,g){a(g.item).css("border-width","0px");a("td",g.item).each(function(i){this.style.width=h.grid.cols[i].style.width});if(h.p.subGrid){var e=a(g.item).attr("id");try{a(h).jqGrid("collapseSubGridRow",e)}catch(d){}}b._start_&&b._start_.apply(this,[c,g])};b.update=function(c,g){a(g.item).css("border-width","");h.p.rownumbers===true&&a("td.jqgrid-rownum",h.rows).each(function(e){a(this).html(e+
1+(parseInt(h.p.page,10)-1)*parseInt(h.p.rowNum,10))});b._update_&&b._update_.apply(this,[c,g])};a("tbody:first",h).sortable(b);a("tbody:first",h).disableSelection()}})},gridDnD:function(b){return this.each(function(){function h(){var e=a.data(c,"dnd");a("tr.jqgrow:not(.ui-draggable)",c).draggable(a.isFunction(e.drag)?e.drag.call(a(c),e):e.drag)}var c=this;if(c.grid)if(!c.p.treeGrid)if(a.fn.draggable&&a.fn.droppable){a("#jqgrid_dnd").html()===null&&a("body").append("<table id='jqgrid_dnd' class='ui-jqgrid-dnd'></table>");
if(typeof b=="string"&&b=="updateDnD"&&c.p.jqgdnd===true)h();else{b=a.extend({drag:function(e){return a.extend({start:function(d,i){if(c.p.subGrid){var j=a(i.helper).attr("id");try{a(c).jqGrid("collapseSubGridRow",j)}catch(m){}}for(j=0;j<a.data(c,"dnd").connectWith.length;j++)a(a.data(c,"dnd").connectWith[j]).jqGrid("getGridParam","reccount")=="0"&&a(a.data(c,"dnd").connectWith[j]).jqGrid("addRowData","jqg_empty_row",{});i.helper.addClass("ui-state-highlight");a("td",i.helper).each(function(n){this.style.width=
c.grid.headers[n].width+"px"});e.onstart&&a.isFunction(e.onstart)&&e.onstart.call(a(c),d,i)},stop:function(d,i){if(i.helper.dropped&&!e.dragcopy){var j=a(i.helper).attr("id");a(c).jqGrid("delRowData",j)}for(j=0;j<a.data(c,"dnd").connectWith.length;j++)a(a.data(c,"dnd").connectWith[j]).jqGrid("delRowData","jqg_empty_row");e.onstop&&a.isFunction(e.onstop)&&e.onstop.call(a(c),d,i)}},e.drag_opts||{})},drop:function(e){return a.extend({accept:function(d){if(!a(d).hasClass("jqgrow"))return d;d=a(d).closest("table.ui-jqgrid-btable");
if(d.length>0&&a.data(d[0],"dnd")!==undefined){d=a.data(d[0],"dnd").connectWith;return a.inArray("#"+this.id,d)!=-1?true:false}return false},drop:function(d,i){if(a(i.draggable).hasClass("jqgrow")){var j=a(i.draggable).attr("id");j=i.draggable.parent().parent().jqGrid("getRowData",j);if(!e.dropbyname){var m=0,n={},l,f=a("#"+this.id).jqGrid("getGridParam","colModel");try{for(var k in j){if(j.hasOwnProperty(k)&&f[m]){l=f[m].name;n[l]=j[k]}m++}j=n}catch(p){}}i.helper.dropped=true;if(e.beforedrop&&a.isFunction(e.beforedrop)){l=
e.beforedrop.call(this,d,i,j,a("#"+c.id),a(this));if(typeof l!="undefined"&&l!==null&&typeof l=="object")j=l}if(i.helper.dropped){var o;if(e.autoid)if(a.isFunction(e.autoid))o=e.autoid.call(this,j);else{o=Math.ceil(Math.random()*1E3);o=e.autoidprefix+o}a("#"+this.id).jqGrid("addRowData",o,j,e.droppos)}e.ondrop&&a.isFunction(e.ondrop)&&e.ondrop.call(this,d,i,j)}}},e.drop_opts||{})},onstart:null,onstop:null,beforedrop:null,ondrop:null,drop_opts:{activeClass:"ui-state-active",hoverClass:"ui-state-hover"},
drag_opts:{revert:"invalid",helper:"clone",cursor:"move",appendTo:"#jqgrid_dnd",zIndex:5E3},dragcopy:false,dropbyname:false,droppos:"first",autoid:true,autoidprefix:"dnd_"},b||{});if(b.connectWith){b.connectWith=b.connectWith.split(",");b.connectWith=a.map(b.connectWith,function(e){return a.trim(e)});a.data(c,"dnd",b);c.p.reccount!="0"&&!c.p.jqgdnd&&h();c.p.jqgdnd=true;for(var g=0;g<b.connectWith.length;g++)a(b.connectWith[g]).droppable(a.isFunction(b.drop)?b.drop.call(a(c),b):b.drop)}}}})},gridResize:function(b){return this.each(function(){var h=
this;if(h.grid&&a.fn.resizable){b=a.extend({},b||{});if(b.alsoResize){b._alsoResize_=b.alsoResize;delete b.alsoResize}else b._alsoResize_=false;if(b.stop&&a.isFunction(b.stop)){b._stop_=b.stop;delete b.stop}else b._stop_=false;b.stop=function(c,g){a(h).jqGrid("setGridParam",{height:a("#gview_"+h.p.id+" .ui-jqgrid-bdiv").height()});a(h).jqGrid("setGridWidth",g.size.width,b.shrinkToFit);b._stop_&&b._stop_.call(h,c,g)};b.alsoResize=b._alsoResize_?eval("("+("{'#gview_"+h.p.id+" .ui-jqgrid-bdiv':true,'"+
b._alsoResize_+"':true}")+")"):a(".ui-jqgrid-bdiv","#gview_"+h.p.id);delete b._alsoResize_;a("#gbox_"+h.p.id).resizable(b)}})}})})(jQuery);
