(function(a){var d={};a.jgrid.extend({searchGrid:function(f){f=a.extend({recreateFilter:false,drag:true,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",loadDefaults:true,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,afterRedraw:null,closeAfterSearch:false,closeAfterReset:false,closeOnEscape:false,multipleSearch:false,multipleGroup:false,top:0,left:0,jqModal:true,modal:false,resize:true,width:450,height:"auto",dataheight:"auto",showQuery:false,errorcheck:true,
sopt:null,stringResult:undefined,onClose:null,onSearch:null,onReset:null,toTop:true,overlay:30,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:false,layer:null},a.jgrid.search,f||{});return this.each(function(){function b(){if(a.isFunction(f.beforeShowSearch)){w=f.beforeShowSearch(a("#"+q));if(typeof w==="undefined")w=true}if(w){a.jgrid.viewModal("#"+H.themodal,{gbox:"#gbox_"+q,jqm:f.jqModal,modal:f.modal,overlay:f.overlay,toTop:f.toTop});a.isFunction(f.afterShowSearch)&&
f.afterShowSearch(a("#"+q))}}var e=this;if(e.grid){var q="fbox_"+e.p.id,w=true,H={themodal:"searchmod"+q,modalhead:"searchhd"+q,modalcontent:"searchcnt"+q,scrollelm:q},y=e.p.postData[f.sFilter];if(typeof y==="string")y=a.jgrid.parse(y);f.recreateFilter===true&&a("#"+H.themodal).remove();if(a("#"+H.themodal).html()!==null)b();else{var z=a("<div><div id='"+q+"' class='searchFilter' style='overflow:auto'></div></div>").insertBefore("#gview_"+e.p.id),m="left",j="";if(e.p.direction=="rtl"){m="right";j=
" style='text-align:left'";z.attr("dir","rtl")}var s=a.extend([],e.p.colModel),M="<a href='javascript:void(0)' id='"+q+"_search' class='fm-button ui-state-default ui-corner-all fm-button-icon-right ui-reset'><span class='ui-icon ui-icon-search'></span>"+f.Find+"</a>",c="<a href='javascript:void(0)' id='"+q+"_reset' class='fm-button ui-state-default ui-corner-all fm-button-icon-left ui-search'><span class='ui-icon ui-icon-arrowreturnthick-1-w'></span>"+f.Reset+"</a>",t="",o="",i,n=false,F=-1;if(f.showQuery)t=
"<a href='javascript:void(0)' id='"+q+"_query' class='fm-button ui-state-default ui-corner-all fm-button-icon-left'><span class='ui-icon ui-icon-comment'></span>Query</a>";if(f.columns.length)s=f.columns;else a.each(s,function(u,x){if(!x.label)x.label=e.p.colNames[u];if(!n){var G=typeof x.search==="undefined"?true:x.search,k=x.hidden===true;if(x.searchoptions&&x.searchoptions.searchhidden===true&&G||G&&!k){n=true;i=x.index||x.name;F=u}}});if(!y&&i||f.multipleSearch===false){var J="eq";if(F>=0&&s[F].searchoptions&&
s[F].searchoptions.sopt)J=s[F].searchoptions.sopt[0];else if(f.sopt&&f.sopt.length)J=f.sopt[0];y={groupOp:"AND",rules:[{field:i,op:J,data:""}]}}n=false;if(f.tmplNames&&f.tmplNames.length){n=true;o=f.tmplLabel;o+="<select class='ui-template'>";o+="<option value='default'>Default</option>";a.each(f.tmplNames,function(u,x){o+="<option value='"+u+"'>"+x+"</option>"});o+="</select>"}m="<table class='EditTable' style='border:0px none;margin-top:5px' id='"+q+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr><td class='EditButton' style='text-align:"+
m+"'>"+c+o+"</td><td class='EditButton' "+j+">"+t+M+"</td></tr></tbody></table>";a("#"+q).jqFilter({columns:s,filter:f.loadDefaults?y:null,showQuery:f.showQuery,errorcheck:f.errorcheck,sopt:f.sopt,groupButton:f.multipleGroup,ruleButtons:f.multipleSearch,afterRedraw:f.afterRedraw,_gridsopt:a.jgrid.search.odata,ajaxSelectOptions:e.p.ajaxSelectOptions,onChange:function(){this.p.showQuery&&a(".query",this).html(this.toUserFriendlyString())},direction:e.p.direction});z.append(m);n&&f.tmplFilters&&f.tmplFilters.length&&
a(".ui-template",z).bind("change",function(){var u=a(this).val();u=="default"?a("#"+q).jqFilter("addFilter",y):a("#"+q).jqFilter("addFilter",f.tmplFilters[parseInt(u,10)]);return false});if(f.multipleGroup===true)f.multipleSearch=true;a.isFunction(f.onInitializeSearch)&&f.onInitializeSearch(a("#"+q));f.gbox="#gbox_"+q;f.layer?a.jgrid.createModal(H,z,f,"#gview_"+e.p.id,a("#gbox_"+e.p.id)[0],"#"+f.layer,{position:"relative"}):a.jgrid.createModal(H,z,f,"#gview_"+e.p.id,a("#gbox_"+e.p.id)[0]);t&&a("#"+
q+"_query").bind("click",function(){a(".queryresult",z).toggle();return false});if(f.stringResult===undefined)f.stringResult=f.multipleSearch;a("#"+q+"_search").bind("click",function(){var u=a("#"+q),x={},G,k=u.jqFilter("filterData");if(f.errorcheck){u[0].hideError();f.showQuery||u.jqFilter("toSQLString");if(u[0].p.error){u[0].showError();return false}}if(f.stringResult){try{G=xmlJsonClass.toJson(k,"","",false)}catch(B){try{G=JSON.stringify(k)}catch(h){}}if(typeof G==="string"){x[f.sFilter]=G;a.each([f.sField,
f.sValue,f.sOper],function(){x[this]=""})}}else if(f.multipleSearch){x[f.sFilter]=k;a.each([f.sField,f.sValue,f.sOper],function(){x[this]=""})}else{x[f.sField]=k.rules[0].field;x[f.sValue]=k.rules[0].data;x[f.sOper]=k.rules[0].op;x[f.sFilter]=""}e.p.search=true;a.extend(e.p.postData,x);a.isFunction(f.onSearch)&&f.onSearch();a(e).trigger("reloadGrid",[{page:1}]);f.closeAfterSearch&&a.jgrid.hideModal("#"+H.themodal,{gb:"#gbox_"+e.p.id,jqm:f.jqModal,onClose:f.onClose});return false});a("#"+q+"_reset").bind("click",
function(){var u={},x=a("#"+q);e.p.search=false;if(f.multipleSearch===false)u[f.sField]=u[f.sValue]=u[f.sOper]="";else u[f.sFilter]="";x[0].resetFilter();n&&a(".ui-template",z).val("default");a.extend(e.p.postData,u);a.isFunction(f.onReset)&&f.onReset();a(e).trigger("reloadGrid",[{page:1}]);return false});b();a(".fm-button:not(.ui-state-disabled)",z).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")})}}})},editGridRow:function(f,b){b=a.extend({top:0,
left:0,width:300,height:"auto",dataheight:"auto",modal:false,overlay:30,drag:true,resize:true,url:null,mtype:"POST",clearAfterAdd:true,closeAfterEdit:false,reloadAfterSubmit:true,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},recreateForm:false,jqModal:true,closeOnEscape:false,addedrow:"first",topinfo:"",bottominfo:"",saveicon:[],closeicon:[],
savekey:[false,13],navkeys:[false,38,40],checkOnSubmit:false,checkOnUpdate:false,_savedData:{},processing:false,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:true},a.jgrid.edit,b||{});d[a(this)[0].p.id]=b;return this.each(function(){function e(){a("#"+i+" > tbody > tr > td > .FormElement").each(function(){var g=a(".customelement",this);if(g.length){var l=a(g[0]).attr("name");a.each(c.p.colModel,function(){if(this.name===l&&this.editoptions&&a.isFunction(this.editoptions.custom_value)){try{h[l]=
this.editoptions.custom_value(a("#"+a.jgrid.jqID(l),"#"+i),"get");if(h[l]===undefined)throw"e1";}catch(p){p==="e1"?a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.novalue,jQuery.jgrid.edit.bClose):a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,p.message,jQuery.jgrid.edit.bClose)}return true}})}else{switch(a(this).get(0).type){case "checkbox":if(a(this).is(":checked"))h[this.name]=a(this).val();else{g=a(this).attr("offval");h[this.name]=g}break;case "select-one":h[this.name]=
a("option:selected",this).val();O[this.name]=a("option:selected",this).text();break;case "select-multiple":h[this.name]=a(this).val();h[this.name]=h[this.name]?h[this.name].join(","):"";var v=[];a("option:selected",this).each(function(p,D){v[p]=a(D).text()});O[this.name]=v.join(",");break;case "password":case "text":case "textarea":case "button":h[this.name]=a(this).val();break}if(c.p.autoencode)h[this.name]=a.jgrid.htmlEncode(h[this.name])}});return true}function q(g,l,v,p){var D,C,A,L=0,r,R,E,T=
[],I=false,ca="",P;for(P=1;P<=p;P++)ca+="<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>";if(g!="_empty")I=a(l).jqGrid("getInd",g);a(l.p.colModel).each(function(S){D=this.name;R=(C=this.editrules&&this.editrules.edithidden===true?false:this.hidden===true?true:false)?"style='display:none'":"";if(D!=="cb"&&D!=="subgrid"&&this.editable===true&&D!=="rn"){if(I===false)r="";else if(D==l.p.ExpandColumn&&l.p.treeGrid===true)r=a("td:eq("+S+")",l.rows[I]).text();else{try{r=a.unformat(a("td:eq("+
S+")",l.rows[I]),{rowId:g,colModel:this},S)}catch(ea){r=this.edittype&&this.edittype=="textarea"?a("td:eq("+S+")",l.rows[I]).text():a("td:eq("+S+")",l.rows[I]).html()}if(!r||r=="&nbsp;"||r=="&#160;"||r.length==1&&r.charCodeAt(0)==160)r=""}var X=a.extend({},this.editoptions||{},{id:D,name:D}),Y=a.extend({},{elmprefix:"",elmsuffix:"",rowabove:false,rowcontent:""},this.formoptions||{}),da=parseInt(Y.rowpos,10)||L+1,fa=parseInt((parseInt(Y.colpos,10)||1)*2,10);if(g=="_empty"&&X.defaultValue)r=a.isFunction(X.defaultValue)?
X.defaultValue():X.defaultValue;if(!this.edittype)this.edittype="text";if(c.p.autoencode)r=a.jgrid.htmlDecode(r);E=a.jgrid.createEl(this.edittype,X,r,false,a.extend({},a.jgrid.ajaxOptions,l.p.ajaxSelectOptions||{}));if(r===""&&this.edittype=="checkbox")r=a(E).attr("offval");if(r===""&&this.edittype=="select")r=a("option:eq(0)",E).text();if(d[c.p.id].checkOnSubmit||d[c.p.id].checkOnUpdate)d[c.p.id]._savedData[D]=r;a(E).addClass("FormElement");if(this.edittype=="text"||this.edittype=="textarea")a(E).addClass("ui-widget-content ui-corner-all");
A=a(v).find("tr[rowpos="+da+"]");if(Y.rowabove){X=a("<tr><td class='contentinfo' colspan='"+p*2+"'>"+Y.rowcontent+"</td></tr>");a(v).append(X);X[0].rp=da}if(A.length===0){A=a("<tr "+R+" rowpos='"+da+"'></tr>").addClass("FormData").attr("id","tr_"+D);a(A).append(ca);a(v).append(A);A[0].rp=da}a("td:eq("+(fa-2)+")",A[0]).html(typeof Y.label==="undefined"?l.p.colNames[S]:Y.label);a("td:eq("+(fa-1)+")",A[0]).append(Y.elmprefix).append(E).append(Y.elmsuffix);T[L]=S;L++}});if(L>0){P=a("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+
(p*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+l.p.id+"_id' value='"+g+"'/></td></tr>");P[0].rp=L+999;a(v).append(P);if(d[c.p.id].checkOnSubmit||d[c.p.id].checkOnUpdate)d[c.p.id]._savedData[l.p.id+"_id"]=g}return T}function w(g,l,v){var p,D=0,C,A,L,r,R;if(d[c.p.id].checkOnSubmit||d[c.p.id].checkOnUpdate){d[c.p.id]._savedData={};d[c.p.id]._savedData[l.p.id+"_id"]=g}var E=l.p.colModel;if(g=="_empty"){a(E).each(function(){p=this.name;L=a.extend({},this.editoptions||
{});if((A=a("#"+a.jgrid.jqID(p),"#"+v))&&A.length&&A[0]!==null){r="";if(L.defaultValue){r=a.isFunction(L.defaultValue)?L.defaultValue():L.defaultValue;if(A[0].type=="checkbox"){R=r.toLowerCase();if(R.search(/(false|0|no|off|undefined)/i)<0&&R!==""){A[0].checked=true;A[0].defaultChecked=true;A[0].value=r}else{A[0].checked=false;A[0].defaultChecked=false}}else A.val(r)}else if(A[0].type=="checkbox"){A[0].checked=false;A[0].defaultChecked=false;r=a(A).attr("offval")}else if(A[0].type&&A[0].type.substr(0,
6)=="select")A[0].selectedIndex=0;else A.val(r);if(d[c.p.id].checkOnSubmit===true||d[c.p.id].checkOnUpdate)d[c.p.id]._savedData[p]=r}});a("#id_g","#"+v).val(g)}else{var T=a(l).jqGrid("getInd",g,true);if(T){a('td[role="gridcell"]',T).each(function(I){p=E[I].name;if(p!=="cb"&&p!=="subgrid"&&p!=="rn"&&E[I].editable===true){if(p==l.p.ExpandColumn&&l.p.treeGrid===true)C=a(this).text();else try{C=a.unformat(a(this),{rowId:g,colModel:E[I]},I)}catch(ca){C=E[I].edittype=="textarea"?a(this).text():a(this).html()}if(c.p.autoencode)C=
a.jgrid.htmlDecode(C);if(d[c.p.id].checkOnSubmit===true||d[c.p.id].checkOnUpdate)d[c.p.id]._savedData[p]=C;p=a.jgrid.jqID(p);switch(E[I].edittype){case "password":case "text":case "button":case "image":case "textarea":if(C=="&nbsp;"||C=="&#160;"||C.length==1&&C.charCodeAt(0)==160)C="";a("#"+p,"#"+v).val(C);break;case "select":var P=C.split(",");P=a.map(P,function(ea){return a.trim(ea)});a("#"+p+" option","#"+v).each(function(){this.selected=!E[I].editoptions.multiple&&(a.trim(C)==a.trim(a(this).text())||
P[0]==a.trim(a(this).text())||P[0]==a.trim(a(this).val()))?true:E[I].editoptions.multiple?a.inArray(a.trim(a(this).text()),P)>-1||a.inArray(a.trim(a(this).val()),P)>-1?true:false:false});break;case "checkbox":C+="";if(E[I].editoptions&&E[I].editoptions.value)if(E[I].editoptions.value.split(":")[0]==C){a("#"+p,"#"+v)[c.p.useProp?"prop":"attr"]("checked",true);a("#"+p,"#"+v)[c.p.useProp?"prop":"attr"]("defaultChecked",true)}else{a("#"+p,"#"+v)[c.p.useProp?"prop":"attr"]("checked",false);a("#"+p,"#"+
v)[c.p.useProp?"prop":"attr"]("defaultChecked",false)}else{C=C.toLowerCase();if(C.search(/(false|0|no|off|undefined)/i)<0&&C!==""){a("#"+p,"#"+v)[c.p.useProp?"prop":"attr"]("checked",true);a("#"+p,"#"+v)[c.p.useProp?"prop":"attr"]("defaultChecked",true)}else{a("#"+p,"#"+v)[c.p.useProp?"prop":"attr"]("checked",false);a("#"+p,"#"+v)[c.p.useProp?"prop":"attr"]("defaultChecked",false)}}break;case "custom":try{if(E[I].editoptions&&a.isFunction(E[I].editoptions.custom_value))E[I].editoptions.custom_value(a("#"+
p,"#"+v),"set",C);else throw"e1";}catch(S){S=="e1"?a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.nodefined,jQuery.jgrid.edit.bClose):a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,S.message,jQuery.jgrid.edit.bClose)}break}D++}});D>0&&a("#id_g","#"+i).val(g)}}}function H(){a.each(c.p.colModel,function(g,l){if(l.editoptions&&l.editoptions.NullIfEmpty===true)if(h.hasOwnProperty(l.name)&&h[l.name]==="")h[l.name]="null"})}function y(){var g,l=[true,"",""],v=
{},p=c.p.prmNames,D,C,A,L,r;if(a.isFunction(d[c.p.id].beforeCheckValues)){var R=d[c.p.id].beforeCheckValues(h,a("#"+o),h[c.p.id+"_id"]=="_empty"?p.addoper:p.editoper);if(R&&typeof R==="object")h=R}for(A in h)if(h.hasOwnProperty(A)){l=a.jgrid.checkValues(h[A],A,c);if(l[0]===false)break}H();if(l[0]){if(a.isFunction(d[c.p.id].onclickSubmit))v=d[c.p.id].onclickSubmit(d[c.p.id],h)||{};if(a.isFunction(d[c.p.id].beforeSubmit))l=d[c.p.id].beforeSubmit(h,a("#"+o))}if(l[0]&&!d[c.p.id].processing){d[c.p.id].processing=
true;a("#sData","#"+i+"_2").addClass("ui-state-active");C=p.oper;D=p.id;h[C]=a.trim(h[c.p.id+"_id"])=="_empty"?p.addoper:p.editoper;if(h[C]!=p.addoper)h[D]=h[c.p.id+"_id"];else if(h[D]===undefined)h[D]=h[c.p.id+"_id"];delete h[c.p.id+"_id"];h=a.extend(h,d[c.p.id].editData,v);if(c.p.treeGrid===true){if(h[C]==p.addoper){L=a(c).jqGrid("getGridParam","selrow");h[c.p.treeGridModel=="adjacency"?c.p.treeReader.parent_id_field:"parent_id"]=L}for(r in c.p.treeReader)if(c.p.treeReader.hasOwnProperty(r)){v=
c.p.treeReader[r];if(h.hasOwnProperty(v))h[C]==p.addoper&&r==="parent_id_field"||delete h[v]}}h[D]=a.jgrid.stripPref(c.p.idPrefix,h[D]);r=a.extend({url:d[c.p.id].url?d[c.p.id].url:a(c).jqGrid("getGridParam","editurl"),type:d[c.p.id].mtype,data:a.isFunction(d[c.p.id].serializeEditData)?d[c.p.id].serializeEditData(h):h,complete:function(E,T){h[D]=c.p.idPrefix+h[D];if(T!="success"){l[0]=false;l[1]=a.isFunction(d[c.p.id].errorTextFormat)?d[c.p.id].errorTextFormat(E):T+" Status: '"+E.statusText+"'. Error code: "+
E.status}else if(a.isFunction(d[c.p.id].afterSubmit))l=d[c.p.id].afterSubmit(E,h);if(l[0]===false){a("#FormError>td","#"+i).html(l[1]);a("#FormError","#"+i).show()}else{a.each(c.p.colModel,function(){if(O[this.name]&&this.formatter&&this.formatter=="select")try{delete O[this.name]}catch(P){}});h=a.extend(h,O);c.p.autoencode&&a.each(h,function(P,S){h[P]=a.jgrid.htmlDecode(S)});if(h[C]==p.addoper){l[2]||(l[2]=a.jgrid.randId());h[D]=l[2];if(d[c.p.id].closeAfterAdd){if(d[c.p.id].reloadAfterSubmit)a(c).trigger("reloadGrid");
else if(c.p.treeGrid===true)a(c).jqGrid("addChildNode",l[2],L,h);else{a(c).jqGrid("addRowData",l[2],h,b.addedrow);a(c).jqGrid("setSelection",l[2])}a.jgrid.hideModal("#"+n.themodal,{gb:"#gbox_"+t,jqm:b.jqModal,onClose:d[c.p.id].onClose})}else if(d[c.p.id].clearAfterAdd){if(d[c.p.id].reloadAfterSubmit)a(c).trigger("reloadGrid");else c.p.treeGrid===true?a(c).jqGrid("addChildNode",l[2],L,h):a(c).jqGrid("addRowData",l[2],h,b.addedrow);w("_empty",c,o)}else if(d[c.p.id].reloadAfterSubmit)a(c).trigger("reloadGrid");
else c.p.treeGrid===true?a(c).jqGrid("addChildNode",l[2],L,h):a(c).jqGrid("addRowData",l[2],h,b.addedrow)}else{if(d[c.p.id].reloadAfterSubmit){a(c).trigger("reloadGrid");d[c.p.id].closeAfterEdit||setTimeout(function(){a(c).jqGrid("setSelection",h[D])},1E3)}else c.p.treeGrid===true?a(c).jqGrid("setTreeRow",h[D],h):a(c).jqGrid("setRowData",h[D],h);d[c.p.id].closeAfterEdit&&a.jgrid.hideModal("#"+n.themodal,{gb:"#gbox_"+t,jqm:b.jqModal,onClose:d[c.p.id].onClose})}if(a.isFunction(d[c.p.id].afterComplete)){g=
E;setTimeout(function(){d[c.p.id].afterComplete(g,h,a("#"+o));g=null},500)}if(d[c.p.id].checkOnSubmit||d[c.p.id].checkOnUpdate){a("#"+o).data("disabled",false);if(d[c.p.id]._savedData[c.p.id+"_id"]!="_empty")for(var I in d[c.p.id]._savedData)if(h[I])d[c.p.id]._savedData[I]=h[I]}}d[c.p.id].processing=false;a("#sData","#"+i+"_2").removeClass("ui-state-active");try{a(":input:visible","#"+o)[0].focus()}catch(ca){}}},a.jgrid.ajaxOptions,d[c.p.id].ajaxEditOptions);if(!r.url&&!d[c.p.id].useDataProxy)if(a.isFunction(c.p.dataProxy))d[c.p.id].useDataProxy=
true;else{l[0]=false;l[1]+=" "+a.jgrid.errors.nourl}if(l[0])if(d[c.p.id].useDataProxy){v=c.p.dataProxy.call(c,r,"set_"+c.p.id);if(typeof v=="undefined")v=[true,""];if(v[0]===false){l[0]=false;l[1]=v[1]||"Error deleting the selected row!"}else{r.data.oper==p.addoper&&d[c.p.id].closeAfterAdd&&a.jgrid.hideModal("#"+n.themodal,{gb:"#gbox_"+t,jqm:b.jqModal,onClose:d[c.p.id].onClose});r.data.oper==p.editoper&&d[c.p.id].closeAfterEdit&&a.jgrid.hideModal("#"+n.themodal,{gb:"#gbox_"+t,jqm:b.jqModal,onClose:d[c.p.id].onClose})}}else a.ajax(r)}if(l[0]===
false){a("#FormError>td","#"+i).html(l[1]);a("#FormError","#"+i).show()}}function z(g,l){var v=false,p;for(p in g)if(g[p]!=l[p]){v=true;break}return v}function m(){var g=true;a("#FormError","#"+i).hide();if(d[c.p.id].checkOnUpdate){h={};O={};e();N=a.extend({},h,O);if(U=z(N,d[c.p.id]._savedData)){a("#"+o).data("disabled",true);a(".confirm","#"+n.themodal).show();g=false}}return g}function j(){if(f!=="_empty"&&typeof c.p.savedRow!=="undefined"&&c.p.savedRow.length>0&&a.isFunction(a.fn.jqGrid.restoreRow))for(var g=
0;g<c.p.savedRow.length;g++)if(c.p.savedRow[g].id==f){a(c).jqGrid("restoreRow",f);break}}function s(g,l){g===0?a("#pData","#"+i+"_2").addClass("ui-state-disabled"):a("#pData","#"+i+"_2").removeClass("ui-state-disabled");g==l?a("#nData","#"+i+"_2").addClass("ui-state-disabled"):a("#nData","#"+i+"_2").removeClass("ui-state-disabled")}function M(){var g=a(c).jqGrid("getDataIDs"),l=a("#id_g","#"+i).val();return[a.inArray(l,g),g]}var c=this;if(c.grid&&f){var t=c.p.id,o="FrmGrid_"+t,i="TblGrid_"+t,n={themodal:"editmod"+
t,modalhead:"edithd"+t,modalcontent:"editcnt"+t,scrollelm:o},F=a.isFunction(d[c.p.id].beforeShowForm)?d[c.p.id].beforeShowForm:false,J=a.isFunction(d[c.p.id].afterShowForm)?d[c.p.id].afterShowForm:false,u=a.isFunction(d[c.p.id].beforeInitData)?d[c.p.id].beforeInitData:false,x=a.isFunction(d[c.p.id].onInitializeForm)?d[c.p.id].onInitializeForm:false,G=true,k=1,B=0,h,O,N,U;if(f==="new"){f="_empty";b.caption=d[c.p.id].addCaption}else b.caption=d[c.p.id].editCaption;b.recreateForm===true&&a("#"+n.themodal).html()!==
null&&a("#"+n.themodal).remove();var Q=true;if(b.checkOnUpdate&&b.jqModal&&!b.modal)Q=false;if(a("#"+n.themodal).html()!==null){if(u){G=u(a("#"+o));if(typeof G=="undefined")G=true}if(G===false)return;j();a(".ui-jqdialog-title","#"+n.modalhead).html(b.caption);a("#FormError","#"+i).hide();if(d[c.p.id].topinfo){a(".topinfo","#"+i).html(d[c.p.id].topinfo);a(".tinfo","#"+i).show()}else a(".tinfo","#"+i).hide();if(d[c.p.id].bottominfo){a(".bottominfo","#"+i+"_2").html(d[c.p.id].bottominfo);a(".binfo",
"#"+i+"_2").show()}else a(".binfo","#"+i+"_2").hide();w(f,c,o);f=="_empty"||!d[c.p.id].viewPagerButtons?a("#pData, #nData","#"+i+"_2").hide():a("#pData, #nData","#"+i+"_2").show();if(d[c.p.id].processing===true){d[c.p.id].processing=false;a("#sData","#"+i+"_2").removeClass("ui-state-active")}if(a("#"+o).data("disabled")===true){a(".confirm","#"+n.themodal).hide();a("#"+o).data("disabled",false)}F&&F(a("#"+o));a("#"+n.themodal).data("onClose",d[c.p.id].onClose);a.jgrid.viewModal("#"+n.themodal,{gbox:"#gbox_"+
t,jqm:b.jqModal,jqM:false,overlay:b.overlay,modal:b.modal});Q||a(".jqmOverlay").click(function(){if(!m())return false;a.jgrid.hideModal("#"+n.themodal,{gb:"#gbox_"+t,jqm:b.jqModal,onClose:d[c.p.id].onClose});return false});J&&J(a("#"+o))}else{var K=isNaN(b.dataheight)?b.dataheight:b.dataheight+"px";K=a("<form name='FormPost' id='"+o+"' class='FormGrid' onSubmit='return false;' style='width:100%;overflow:auto;position:relative;height:"+K+";'></form>").data("disabled",false);var V=a("<table id='"+i+
"' class='EditTable' cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>");if(u){G=u(a("#"+o));if(typeof G=="undefined")G=true}if(G===false)return;j();a(c.p.colModel).each(function(){var g=this.formoptions;k=Math.max(k,g?g.colpos||0:0);B=Math.max(B,g?g.rowpos||0:0)});a(K).append(V);u=a("<tr id='FormError' style='display:none'><td class='ui-state-error' colspan='"+k*2+"'></td></tr>");u[0].rp=0;a(V).append(u);u=a("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+
k*2+"'>"+d[c.p.id].topinfo+"</td></tr>");u[0].rp=0;a(V).append(u);G=(u=c.p.direction=="rtl"?true:false)?"nData":"pData";var W=u?"pData":"nData";q(f,c,V,k);G="<a href='javascript:void(0)' id='"+G+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></a>";W="<a href='javascript:void(0)' id='"+W+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></a>";var $="<a href='javascript:void(0)' id='sData' class='fm-button ui-state-default ui-corner-all'>"+
b.bSubmit+"</a>",Z="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+b.bCancel+"</a>";G="<table border='0' cellspacing='0' cellpadding='0' class='EditTable' id='"+i+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton'>"+(u?W+G:G+W)+"</td><td class='EditButton'>"+$+Z+"</td></tr>";G+="<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+d[c.p.id].bottominfo+
"</td></tr>";G+="</tbody></table>";if(B>0){var aa=[];a.each(a(V)[0].rows,function(g,l){aa[g]=l});aa.sort(function(g,l){if(g.rp>l.rp)return 1;if(g.rp<l.rp)return-1;return 0});a.each(aa,function(g,l){a("tbody",V).append(l)})}b.gbox="#gbox_"+t;var ba=false;if(b.closeOnEscape===true){b.closeOnEscape=false;ba=true}K=a("<span></span>").append(K).append(G);a.jgrid.createModal(n,K,b,"#gview_"+c.p.id,a("#gbox_"+c.p.id)[0]);if(u){a("#pData, #nData","#"+i+"_2").css("float","right");a(".EditButton","#"+i+"_2").css("text-align",
"left")}d[c.p.id].topinfo&&a(".tinfo","#"+i).show();d[c.p.id].bottominfo&&a(".binfo","#"+i+"_2").show();G=K=null;a("#"+n.themodal).keydown(function(g){var l=g.target;if(a("#"+o).data("disabled")===true)return false;if(d[c.p.id].savekey[0]===true&&g.which==d[c.p.id].savekey[1])if(l.tagName!="TEXTAREA"){a("#sData","#"+i+"_2").trigger("click");return false}if(g.which===27){if(!m())return false;ba&&a.jgrid.hideModal(this,{gb:b.gbox,jqm:b.jqModal,onClose:d[c.p.id].onClose});return false}if(d[c.p.id].navkeys[0]===
true){if(a("#id_g","#"+i).val()=="_empty")return true;if(g.which==d[c.p.id].navkeys[1]){a("#pData","#"+i+"_2").trigger("click");return false}if(g.which==d[c.p.id].navkeys[2]){a("#nData","#"+i+"_2").trigger("click");return false}}});if(b.checkOnUpdate){a("a.ui-jqdialog-titlebar-close span","#"+n.themodal).removeClass("jqmClose");a("a.ui-jqdialog-titlebar-close","#"+n.themodal).unbind("click").click(function(){if(!m())return false;a.jgrid.hideModal("#"+n.themodal,{gb:"#gbox_"+t,jqm:b.jqModal,onClose:d[c.p.id].onClose});
return false})}b.saveicon=a.extend([true,"left","ui-icon-disk"],b.saveicon);b.closeicon=a.extend([true,"left","ui-icon-close"],b.closeicon);if(b.saveicon[0]===true)a("#sData","#"+i+"_2").addClass(b.saveicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+b.saveicon[2]+"'></span>");if(b.closeicon[0]===true)a("#cData","#"+i+"_2").addClass(b.closeicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+b.closeicon[2]+"'></span>");
if(d[c.p.id].checkOnSubmit||d[c.p.id].checkOnUpdate){$="<a href='javascript:void(0)' id='sNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+b.bYes+"</a>";W="<a href='javascript:void(0)' id='nNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+b.bNo+"</a>";Z="<a href='javascript:void(0)' id='cNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+b.bExit+"</a>";K=b.zIndex||999;K++;a("<div class='ui-widget-overlay jqgrid-overlay confirm' style='z-index:"+
K+";display:none;'>&#160;"+(a.browser.msie&&a.browser.version==6?'<iframe style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');" src="javascript:false;"></iframe>':"")+"</div><div class='confirm ui-widget-content ui-jqconfirm' style='z-index:"+(K+1)+"'>"+b.saveData+"<br/><br/>"+$+W+Z+"</div>").insertAfter("#"+o);a("#sNew","#"+n.themodal).click(function(){y();a("#"+o).data("disabled",false);a(".confirm","#"+n.themodal).hide();return false});a("#nNew","#"+n.themodal).click(function(){a(".confirm",
"#"+n.themodal).hide();a("#"+o).data("disabled",false);setTimeout(function(){a(":input","#"+o)[0].focus()},0);return false});a("#cNew","#"+n.themodal).click(function(){a(".confirm","#"+n.themodal).hide();a("#"+o).data("disabled",false);a.jgrid.hideModal("#"+n.themodal,{gb:"#gbox_"+t,jqm:b.jqModal,onClose:d[c.p.id].onClose});return false})}x&&x(a("#"+o));f=="_empty"||!d[c.p.id].viewPagerButtons?a("#pData,#nData","#"+i+"_2").hide():a("#pData,#nData","#"+i+"_2").show();F&&F(a("#"+o));a("#"+n.themodal).data("onClose",
d[c.p.id].onClose);a.jgrid.viewModal("#"+n.themodal,{gbox:"#gbox_"+t,jqm:b.jqModal,overlay:b.overlay,modal:b.modal});Q||a(".jqmOverlay").click(function(){if(!m())return false;a.jgrid.hideModal("#"+n.themodal,{gb:"#gbox_"+t,jqm:b.jqModal,onClose:d[c.p.id].onClose});return false});J&&J(a("#"+o));a(".fm-button","#"+n.themodal).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});a("#sData","#"+i+"_2").click(function(){h={};O={};a("#FormError","#"+i).hide();
e();if(h[c.p.id+"_id"]=="_empty")y();else if(b.checkOnSubmit===true){N=a.extend({},h,O);if(U=z(N,d[c.p.id]._savedData)){a("#"+o).data("disabled",true);a(".confirm","#"+n.themodal).show()}else y()}else y();return false});a("#cData","#"+i+"_2").click(function(){if(!m())return false;a.jgrid.hideModal("#"+n.themodal,{gb:"#gbox_"+t,jqm:b.jqModal,onClose:d[c.p.id].onClose});return false});a("#nData","#"+i+"_2").click(function(){if(!m())return false;a("#FormError","#"+i).hide();var g=M();g[0]=parseInt(g[0],
10);if(g[0]!=-1&&g[1][g[0]+1]){a.isFunction(b.onclickPgButtons)&&b.onclickPgButtons("next",a("#"+o),g[1][g[0]]);w(g[1][g[0]+1],c,o);a(c).jqGrid("setSelection",g[1][g[0]+1]);a.isFunction(b.afterclickPgButtons)&&b.afterclickPgButtons("next",a("#"+o),g[1][g[0]+1]);s(g[0]+1,g[1].length-1)}return false});a("#pData","#"+i+"_2").click(function(){if(!m())return false;a("#FormError","#"+i).hide();var g=M();if(g[0]!=-1&&g[1][g[0]-1]){a.isFunction(b.onclickPgButtons)&&b.onclickPgButtons("prev",a("#"+o),g[1][g[0]]);
w(g[1][g[0]-1],c,o);a(c).jqGrid("setSelection",g[1][g[0]-1]);a.isFunction(b.afterclickPgButtons)&&b.afterclickPgButtons("prev",a("#"+o),g[1][g[0]-1]);s(g[0]-1,g[1].length-1)}return false})}F=M();s(F[0],F[1].length-1)}})},viewGridRow:function(f,b){b=a.extend({top:0,left:0,width:0,height:"auto",dataheight:"auto",modal:false,overlay:30,drag:true,resize:true,jqModal:true,closeOnEscape:false,labelswidth:"30%",closeicon:[],navkeys:[false,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:true},
a.jgrid.view,b||{});return this.each(function(){function e(){if(b.closeOnEscape===true||b.navkeys[0]===true)setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+M.modalhead).focus()},0)}function q(k,B,h,O){for(var N,U,Q,K=0,V,W,$=[],Z=false,aa="<td class='CaptionTD form-view-label ui-widget-content' width='"+b.labelswidth+"'>&#160;</td><td class='DataTD form-view-data ui-helper-reset ui-widget-content'>&#160;</td>",ba="",g=["integer","number","currency"],l=0,v=0,p,D,C,A=1;A<=O;A++)ba+=A==1?aa:
"<td class='CaptionTD form-view-label ui-widget-content'>&#160;</td><td class='DataTD form-view-data ui-widget-content'>&#160;</td>";a(B.p.colModel).each(function(){U=this.editrules&&this.editrules.edithidden===true?false:this.hidden===true?true:false;if(!U&&this.align==="right")if(this.formatter&&a.inArray(this.formatter,g)!==-1)l=Math.max(l,parseInt(this.width,10));else v=Math.max(v,parseInt(this.width,10))});p=l!==0?l:v!==0?v:0;Z=a(B).jqGrid("getInd",k);a(B.p.colModel).each(function(L){N=this.name;
D=false;W=(U=this.editrules&&this.editrules.edithidden===true?false:this.hidden===true?true:false)?"style='display:none'":"";C=typeof this.viewable!="boolean"?true:this.viewable;if(N!=="cb"&&N!=="subgrid"&&N!=="rn"&&C){V=Z===false?"":N==B.p.ExpandColumn&&B.p.treeGrid===true?a("td:eq("+L+")",B.rows[Z]).text():a("td:eq("+L+")",B.rows[Z]).html();D=this.align==="right"&&p!==0?true:false;a.extend({},this.editoptions||{},{id:N,name:N});var r=a.extend({},{rowabove:false,rowcontent:""},this.formoptions||
{}),R=parseInt(r.rowpos,10)||K+1,E=parseInt((parseInt(r.colpos,10)||1)*2,10);if(r.rowabove){var T=a("<tr><td class='contentinfo' colspan='"+O*2+"'>"+r.rowcontent+"</td></tr>");a(h).append(T);T[0].rp=R}Q=a(h).find("tr[rowpos="+R+"]");if(Q.length===0){Q=a("<tr "+W+" rowpos='"+R+"'></tr>").addClass("FormData").attr("id","trv_"+N);a(Q).append(ba);a(h).append(Q);Q[0].rp=R}a("td:eq("+(E-2)+")",Q[0]).html("<b>"+(typeof r.label==="undefined"?B.p.colNames[L]:r.label)+"</b>");a("td:eq("+(E-1)+")",Q[0]).append("<span>"+
V+"</span>").attr("id","v_"+N);D&&a("td:eq("+(E-1)+") span",Q[0]).css({"text-align":"right",width:p+"px"});$[K]=L;K++}});if(K>0){k=a("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(O*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+k+"'/></td></tr>");k[0].rp=K+99;a(h).append(k)}return $}function w(k,B){var h,O,N=0,U,Q;if(Q=a(B).jqGrid("getInd",k,true)){a("td",Q).each(function(K){h=B.p.colModel[K].name;O=B.p.colModel[K].editrules&&
B.p.colModel[K].editrules.edithidden===true?false:B.p.colModel[K].hidden===true?true:false;if(h!=="cb"&&h!=="subgrid"&&h!=="rn"){U=h==B.p.ExpandColumn&&B.p.treeGrid===true?a(this).text():a(this).html();a.extend({},B.p.colModel[K].editoptions||{});h=a.jgrid.jqID("v_"+h);a("#"+h+" span","#"+s).html(U);O&&a("#"+h,"#"+s).parents("tr:first").hide();N++}});N>0&&a("#id_g","#"+s).val(k)}}function H(k,B){k===0?a("#pData","#"+s+"_2").addClass("ui-state-disabled"):a("#pData","#"+s+"_2").removeClass("ui-state-disabled");
k==B?a("#nData","#"+s+"_2").addClass("ui-state-disabled"):a("#nData","#"+s+"_2").removeClass("ui-state-disabled")}function y(){var k=a(z).jqGrid("getDataIDs"),B=a("#id_g","#"+s).val();return[a.inArray(B,k),k]}var z=this;if(z.grid&&f){var m=z.p.id,j="ViewGrid_"+m,s="ViewTbl_"+m,M={themodal:"viewmod"+m,modalhead:"viewhd"+m,modalcontent:"viewcnt"+m,scrollelm:j},c=a.isFunction(b.beforeInitData)?b.beforeInitData:false,t=true,o=1,i=0;if(a("#"+M.themodal).html()!==null){if(c){t=c(a("#"+j));if(typeof t==
"undefined")t=true}if(t===false)return;a(".ui-jqdialog-title","#"+M.modalhead).html(b.caption);a("#FormError","#"+s).hide();w(f,z);a.isFunction(b.beforeShowForm)&&b.beforeShowForm(a("#"+j));a.jgrid.viewModal("#"+M.themodal,{gbox:"#gbox_"+m,jqm:b.jqModal,jqM:false,overlay:b.overlay,modal:b.modal});e()}else{var n=isNaN(b.dataheight)?b.dataheight:b.dataheight+"px";n=a("<form name='FormPost' id='"+j+"' class='FormGrid' style='width:100%;overflow:auto;position:relative;height:"+n+";'></form>");var F=a("<table id='"+
s+"' class='EditTable' cellspacing='1' cellpadding='2' border='0' style='table-layout:fixed'><tbody></tbody></table>");if(c){t=c(a("#"+j));if(typeof t=="undefined")t=true}if(t===false)return;a(z.p.colModel).each(function(){var k=this.formoptions;o=Math.max(o,k?k.colpos||0:0);i=Math.max(i,k?k.rowpos||0:0)});a(n).append(F);q(f,z,F,o);c=z.p.direction=="rtl"?true:false;t="<a href='javascript:void(0)' id='"+(c?"nData":"pData")+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></a>";
var J="<a href='javascript:void(0)' id='"+(c?"pData":"nData")+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></a>",u="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+b.bClose+"</a>";if(i>0){var x=[];a.each(a(F)[0].rows,function(k,B){x[k]=B});x.sort(function(k,B){if(k.rp>B.rp)return 1;if(k.rp<B.rp)return-1;return 0});a.each(x,function(k,B){a("tbody",F).append(B)})}b.gbox="#gbox_"+m;var G=false;if(b.closeOnEscape===
true){b.closeOnEscape=false;G=true}n=a("<span></span>").append(n).append("<table border='0' class='EditTable' id='"+s+"_2'><tbody><tr id='Act_Buttons'><td class='navButton' width='"+b.labelswidth+"'>"+(c?J+t:t+J)+"</td><td class='EditButton'>"+u+"</td></tr></tbody></table>");a.jgrid.createModal(M,n,b,"#gview_"+z.p.id,a("#gview_"+z.p.id)[0]);if(c){a("#pData, #nData","#"+s+"_2").css("float","right");a(".EditButton","#"+s+"_2").css("text-align","left")}b.viewPagerButtons||a("#pData, #nData","#"+s+"_2").hide();
n=null;a("#"+M.themodal).keydown(function(k){if(k.which===27){G&&a.jgrid.hideModal(this,{gb:b.gbox,jqm:b.jqModal,onClose:b.onClose});return false}if(b.navkeys[0]===true){if(k.which===b.navkeys[1]){a("#pData","#"+s+"_2").trigger("click");return false}if(k.which===b.navkeys[2]){a("#nData","#"+s+"_2").trigger("click");return false}}});b.closeicon=a.extend([true,"left","ui-icon-close"],b.closeicon);if(b.closeicon[0]===true)a("#cData","#"+s+"_2").addClass(b.closeicon[1]=="right"?"fm-button-icon-right":
"fm-button-icon-left").append("<span class='ui-icon "+b.closeicon[2]+"'></span>");a.isFunction(b.beforeShowForm)&&b.beforeShowForm(a("#"+j));a.jgrid.viewModal("#"+M.themodal,{gbox:"#gbox_"+m,jqm:b.jqModal,modal:b.modal});a(".fm-button:not(.ui-state-disabled)","#"+s+"_2").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});e();a("#cData","#"+s+"_2").click(function(){a.jgrid.hideModal("#"+M.themodal,{gb:"#gbox_"+m,jqm:b.jqModal,onClose:b.onClose});
return false});a("#nData","#"+s+"_2").click(function(){a("#FormError","#"+s).hide();var k=y();k[0]=parseInt(k[0],10);if(k[0]!=-1&&k[1][k[0]+1]){a.isFunction(b.onclickPgButtons)&&b.onclickPgButtons("next",a("#"+j),k[1][k[0]]);w(k[1][k[0]+1],z);a(z).jqGrid("setSelection",k[1][k[0]+1]);a.isFunction(b.afterclickPgButtons)&&b.afterclickPgButtons("next",a("#"+j),k[1][k[0]+1]);H(k[0]+1,k[1].length-1)}e();return false});a("#pData","#"+s+"_2").click(function(){a("#FormError","#"+s).hide();var k=y();if(k[0]!=
-1&&k[1][k[0]-1]){a.isFunction(b.onclickPgButtons)&&b.onclickPgButtons("prev",a("#"+j),k[1][k[0]]);w(k[1][k[0]-1],z);a(z).jqGrid("setSelection",k[1][k[0]-1]);a.isFunction(b.afterclickPgButtons)&&b.afterclickPgButtons("prev",a("#"+j),k[1][k[0]-1]);H(k[0]-1,k[1].length-1)}e();return false})}n=y();H(n[0],n[1].length-1)}})},delGridRow:function(f,b){b=a.extend({top:0,left:0,width:240,height:"auto",dataheight:"auto",modal:false,overlay:30,drag:true,resize:true,url:"",mtype:"POST",reloadAfterSubmit:true,
beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,jqModal:true,closeOnEscape:false,delData:{},delicon:[],cancelicon:[],onClose:null,ajaxDelOptions:{},processing:false,serializeDelData:null,useDataProxy:false},a.jgrid.del,b||{});d[a(this)[0].p.id]=b;return this.each(function(){var e=this;if(e.grid)if(f){var q=a.isFunction(d[e.p.id].beforeShowForm),w=a.isFunction(d[e.p.id].afterShowForm),H=a.isFunction(d[e.p.id].beforeInitData)?d[e.p.id].beforeInitData:
false,y=e.p.id,z={},m=true,j="DelTbl_"+y,s,M,c,t,o={themodal:"delmod"+y,modalhead:"delhd"+y,modalcontent:"delcnt"+y,scrollelm:j};if(jQuery.isArray(f))f=f.join();if(a("#"+o.themodal).html()!==null){if(H){m=H(a("#"+j));if(typeof m=="undefined")m=true}if(m===false)return;a("#DelData>td","#"+j).text(f);a("#DelError","#"+j).hide();if(d[e.p.id].processing===true){d[e.p.id].processing=false;a("#dData","#"+j).removeClass("ui-state-active")}q&&d[e.p.id].beforeShowForm(a("#"+j));a.jgrid.viewModal("#"+o.themodal,
{gbox:"#gbox_"+y,jqm:d[e.p.id].jqModal,jqM:false,overlay:d[e.p.id].overlay,modal:d[e.p.id].modal})}else{var i=isNaN(d[e.p.id].dataheight)?d[e.p.id].dataheight:d[e.p.id].dataheight+"px";i="<div id='"+j+"' class='formdata' style='width:100%;overflow:auto;position:relative;height:"+i+";'>";i+="<table class='DelTable'><tbody>";i+="<tr id='DelError' style='display:none'><td class='ui-state-error'></td></tr>";i+="<tr id='DelData' style='display:none'><td >"+f+"</td></tr>";i+='<tr><td class="delmsg" style="white-space:pre;">'+
d[e.p.id].msg+"</td></tr><tr><td >&#160;</td></tr>";i+="</tbody></table></div>";i+="<table cellspacing='0' cellpadding='0' border='0' class='EditTable' id='"+j+"_2'><tbody><tr><td><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr><td class='DelButton EditButton'>"+("<a href='javascript:void(0)' id='dData' class='fm-button ui-state-default ui-corner-all'>"+b.bSubmit+"</a>")+"&#160;"+("<a href='javascript:void(0)' id='eData' class='fm-button ui-state-default ui-corner-all'>"+b.bCancel+
"</a>")+"</td></tr></tbody></table>";b.gbox="#gbox_"+y;a.jgrid.createModal(o,i,b,"#gview_"+e.p.id,a("#gview_"+e.p.id)[0]);if(H){m=H(a("#"+j));if(typeof m=="undefined")m=true}if(m===false)return;a(".fm-button","#"+j+"_2").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});b.delicon=a.extend([true,"left","ui-icon-scissors"],d[e.p.id].delicon);b.cancelicon=a.extend([true,"left","ui-icon-cancel"],d[e.p.id].cancelicon);if(b.delicon[0]===true)a("#dData",
"#"+j+"_2").addClass(b.delicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+b.delicon[2]+"'></span>");if(b.cancelicon[0]===true)a("#eData","#"+j+"_2").addClass(b.cancelicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+b.cancelicon[2]+"'></span>");a("#dData","#"+j+"_2").click(function(){var n=[true,""];z={};var F=a("#DelData>td","#"+j).text();if(a.isFunction(d[e.p.id].onclickSubmit))z=d[e.p.id].onclickSubmit(d[e.p.id],
F)||{};if(a.isFunction(d[e.p.id].beforeSubmit))n=d[e.p.id].beforeSubmit(F);if(n[0]&&!d[e.p.id].processing){d[e.p.id].processing=true;a(this).addClass("ui-state-active");c=e.p.prmNames;s=a.extend({},d[e.p.id].delData,z);t=c.oper;s[t]=c.deloper;M=c.id;F=F.split(",");for(var J in F)if(F.hasOwnProperty(J))F[J]=a.jgrid.stripPref(e.p.idPrefix,F[J]);s[M]=F.join();J=a.extend({url:d[e.p.id].url?d[e.p.id].url:a(e).jqGrid("getGridParam","editurl"),type:d[e.p.id].mtype,data:a.isFunction(d[e.p.id].serializeDelData)?
d[e.p.id].serializeDelData(s):s,complete:function(u,x){if(x!="success"){n[0]=false;n[1]=a.isFunction(d[e.p.id].errorTextFormat)?d[e.p.id].errorTextFormat(u):x+" Status: '"+u.statusText+"'. Error code: "+u.status}else if(a.isFunction(d[e.p.id].afterSubmit))n=d[e.p.id].afterSubmit(u,s);if(n[0]===false){a("#DelError>td","#"+j).html(n[1]);a("#DelError","#"+j).show()}else{if(d[e.p.id].reloadAfterSubmit&&e.p.datatype!="local")a(e).trigger("reloadGrid");else{x=[];x=F.split(",");if(e.p.treeGrid===true)try{a(e).jqGrid("delTreeNode",
e.p.idPrefix+x[0])}catch(G){}else for(var k=0;k<x.length;k++)a(e).jqGrid("delRowData",e.p.idPrefix+x[k]);e.p.selrow=null;e.p.selarrrow=[]}a.isFunction(d[e.p.id].afterComplete)&&setTimeout(function(){d[e.p.id].afterComplete(u,F)},500)}d[e.p.id].processing=false;a("#dData","#"+j+"_2").removeClass("ui-state-active");n[0]&&a.jgrid.hideModal("#"+o.themodal,{gb:"#gbox_"+y,jqm:b.jqModal,onClose:d[e.p.id].onClose})}},a.jgrid.ajaxOptions,d[e.p.id].ajaxDelOptions);if(!J.url&&!d[e.p.id].useDataProxy)if(a.isFunction(e.p.dataProxy))d[e.p.id].useDataProxy=
true;else{n[0]=false;n[1]+=" "+a.jgrid.errors.nourl}if(n[0])if(d[e.p.id].useDataProxy){J=e.p.dataProxy.call(e,J,"del_"+e.p.id);if(typeof J=="undefined")J=[true,""];if(J[0]===false){n[0]=false;n[1]=J[1]||"Error deleting the selected row!"}else a.jgrid.hideModal("#"+o.themodal,{gb:"#gbox_"+y,jqm:b.jqModal,onClose:d[e.p.id].onClose})}else a.ajax(J)}if(n[0]===false){a("#DelError>td","#"+j).html(n[1]);a("#DelError","#"+j).show()}return false});a("#eData","#"+j+"_2").click(function(){a.jgrid.hideModal("#"+
o.themodal,{gb:"#gbox_"+y,jqm:d[e.p.id].jqModal,onClose:d[e.p.id].onClose});return false});q&&d[e.p.id].beforeShowForm(a("#"+j));a.jgrid.viewModal("#"+o.themodal,{gbox:"#gbox_"+y,jqm:d[e.p.id].jqModal,overlay:d[e.p.id].overlay,modal:d[e.p.id].modal})}w&&d[e.p.id].afterShowForm(a("#"+j));d[e.p.id].closeOnEscape===true&&setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+o.modalhead).focus()},0)}})},navGrid:function(f,b,e,q,w,H,y){b=a.extend({edit:true,editicon:"ui-icon-pencil",add:true,addicon:"ui-icon-plus",
del:true,delicon:"ui-icon-trash",search:true,searchicon:"ui-icon-search",refresh:true,refreshicon:"ui-icon-refresh",refreshstate:"firstpage",view:false,viewicon:"ui-icon-document",position:"left",closeOnEscape:true,beforeRefresh:null,afterRefresh:null,cloneToTop:false,alertwidth:200,alertheight:"auto",alerttop:null,alertleft:null,alertzIndex:null},a.jgrid.nav,b||{});return this.each(function(){if(!this.nav){var z={themodal:"alertmod",modalhead:"alerthd",modalcontent:"alertcnt"},m=this,j;if(!(!m.grid||
typeof f!="string")){if(a("#"+z.themodal).html()===null){if(!b.alerttop&&!b.alertleft){if(typeof window.innerWidth!="undefined"){b.alertleft=window.innerWidth;b.alerttop=window.innerHeight}else if(typeof document.documentElement!="undefined"&&typeof document.documentElement.clientWidth!="undefined"&&document.documentElement.clientWidth!==0){b.alertleft=document.documentElement.clientWidth;b.alerttop=document.documentElement.clientHeight}else{b.alertleft=1024;b.alerttop=768}b.alertleft=b.alertleft/
2-parseInt(b.alertwidth,10)/2;b.alerttop=b.alerttop/2-25}a.jgrid.createModal(z,"<div>"+b.alerttext+"</div><span tabindex='0'><span tabindex='-1' id='jqg_alrt'></span></span>",{gbox:"#gbox_"+m.p.id,jqModal:true,drag:true,resize:true,caption:b.alertcap,top:b.alerttop,left:b.alertleft,width:b.alertwidth,height:b.alertheight,closeOnEscape:b.closeOnEscape,zIndex:b.alertzIndex},"","",true)}var s=1;if(b.cloneToTop&&m.p.toppager)s=2;for(var M=0;M<s;M++){var c=a("<table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table navtable' style='float:left;table-layout:auto;'><tbody><tr></tr></tbody></table>"),
t,o;if(M===0){t=f;o=m.p.id;if(t==m.p.toppager){o+="_top";s=1}}else{t=m.p.toppager;o=m.p.id+"_top"}m.p.direction=="rtl"&&a(c).attr("dir","rtl").css("float","right");if(b.add){q=q||{};j=a("<td class='ui-pg-button ui-corner-all'></td>");a(j).append("<div class='ui-pg-div'><span class='ui-icon "+b.addicon+"'></span>"+b.addtext+"</div>");a("tr",c).append(j);a(j,c).attr({title:b.addtitle||"",id:q.id||"add_"+o}).click(function(){a(this).hasClass("ui-state-disabled")||(a.isFunction(b.addfunc)?b.addfunc():
a(m).jqGrid("editGridRow","new",q));return false}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});j=null}if(b.edit){j=a("<td class='ui-pg-button ui-corner-all'></td>");e=e||{};a(j).append("<div class='ui-pg-div'><span class='ui-icon "+b.editicon+"'></span>"+b.edittext+"</div>");a("tr",c).append(j);a(j,c).attr({title:b.edittitle||"",id:e.id||"edit_"+o}).click(function(){if(!a(this).hasClass("ui-state-disabled")){var i=
m.p.selrow;if(i)a.isFunction(b.editfunc)?b.editfunc(i):a(m).jqGrid("editGridRow",i,e);else{a.jgrid.viewModal("#"+z.themodal,{gbox:"#gbox_"+m.p.id,jqm:true});a("#jqg_alrt").focus()}}return false}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});j=null}if(b.view){j=a("<td class='ui-pg-button ui-corner-all'></td>");y=y||{};a(j).append("<div class='ui-pg-div'><span class='ui-icon "+b.viewicon+"'></span>"+b.viewtext+
"</div>");a("tr",c).append(j);a(j,c).attr({title:b.viewtitle||"",id:y.id||"view_"+o}).click(function(){if(!a(this).hasClass("ui-state-disabled")){var i=m.p.selrow;if(i)a.isFunction(b.viewfunc)?b.viewfunc(i):a(m).jqGrid("viewGridRow",i,y);else{a.jgrid.viewModal("#"+z.themodal,{gbox:"#gbox_"+m.p.id,jqm:true});a("#jqg_alrt").focus()}}return false}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});j=null}if(b.del){j=
a("<td class='ui-pg-button ui-corner-all'></td>");w=w||{};a(j).append("<div class='ui-pg-div'><span class='ui-icon "+b.delicon+"'></span>"+b.deltext+"</div>");a("tr",c).append(j);a(j,c).attr({title:b.deltitle||"",id:w.id||"del_"+o}).click(function(){if(!a(this).hasClass("ui-state-disabled")){var i;if(m.p.multiselect){i=m.p.selarrrow;if(i.length===0)i=null}else i=m.p.selrow;if(i)"function"==typeof b.delfunc?b.delfunc(i):a(m).jqGrid("delGridRow",i,w);else{a.jgrid.viewModal("#"+z.themodal,{gbox:"#gbox_"+
m.p.id,jqm:true});a("#jqg_alrt").focus()}}return false}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});j=null}if(b.add||b.edit||b.del||b.view)a("tr",c).append("<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>");if(b.search){j=a("<td class='ui-pg-button ui-corner-all'></td>");H=H||{};a(j).append("<div class='ui-pg-div'><span class='ui-icon "+b.searchicon+
"'></span>"+b.searchtext+"</div>");a("tr",c).append(j);a(j,c).attr({title:b.searchtitle||"",id:H.id||"search_"+o}).click(function(){a(this).hasClass("ui-state-disabled")||a(m).jqGrid("searchGrid",H);return false}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});H.showOnLoad&&H.showOnLoad===true&&a(j,c).click();j=null}if(b.refresh){j=a("<td class='ui-pg-button ui-corner-all'></td>");a(j).append("<div class='ui-pg-div'><span class='ui-icon "+
b.refreshicon+"'></span>"+b.refreshtext+"</div>");a("tr",c).append(j);a(j,c).attr({title:b.refreshtitle||"",id:"refresh_"+o}).click(function(){if(!a(this).hasClass("ui-state-disabled")){a.isFunction(b.beforeRefresh)&&b.beforeRefresh();m.p.search=false;try{var i=m.p.id;m.p.postData.filters="";a("#fbox_"+i).jqFilter("resetFilter");a.isFunction(m.clearToolbar)&&m.clearToolbar(false)}catch(n){}switch(b.refreshstate){case "firstpage":a(m).trigger("reloadGrid",[{page:1}]);break;case "current":a(m).trigger("reloadGrid",
[{current:true}]);break}a.isFunction(b.afterRefresh)&&b.afterRefresh()}return false}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});j=null}j=a(".ui-jqgrid").css("font-size")||"11px";a("body").append("<div id='testpg2' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+j+";visibility:hidden;' ></div>");j=a(c).clone().appendTo("#testpg2").width();a("#testpg2").remove();a(t+"_"+b.position,t).append(c);
if(m.p._nvtd){if(j>m.p._nvtd[0]){a(t+"_"+b.position,t).width(j);m.p._nvtd[0]=j}m.p._nvtd[1]=j}c=j=j=null;this.nav=true}}}})},navButtonAdd:function(f,b){b=a.extend({caption:"newButton",title:"",buttonicon:"ui-icon-newwin",onClickButton:null,position:"last",cursor:"pointer"},b||{});return this.each(function(){if(this.grid){if(f.indexOf("#")!==0)f="#"+f;var e=a(".navtable",f)[0],q=this;if(e)if(!(b.id&&a("#"+b.id,e).html()!==null)){var w=a("<td></td>");b.buttonicon.toString().toUpperCase()=="NONE"?a(w).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'>"+
b.caption+"</div>"):a(w).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'><span class='ui-icon "+b.buttonicon+"'></span>"+b.caption+"</div>");b.id&&a(w).attr("id",b.id);if(b.position=="first")e.rows[0].cells.length===0?a("tr",e).append(w):a("tr td:eq(0)",e).before(w);else a("tr",e).append(w);a(w,e).attr("title",b.title||"").click(function(H){a(this).hasClass("ui-state-disabled")||a.isFunction(b.onClickButton)&&b.onClickButton.call(q,H);return false}).hover(function(){a(this).hasClass("ui-state-disabled")||
a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")})}}})},navSeparatorAdd:function(f,b){b=a.extend({sepclass:"ui-separator",sepcontent:""},b||{});return this.each(function(){if(this.grid){if(f.indexOf("#")!==0)f="#"+f;var e=a(".navtable",f)[0];if(e){var q="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='"+b.sepclass+"'></span>"+b.sepcontent+"</td>";a("tr",e).append(q)}}})},GridToForm:function(f,b){return this.each(function(){var e=this;
if(e.grid){var q=a(e).jqGrid("getRowData",f);if(q)for(var w in q)a("[name="+a.jgrid.jqID(w)+"]",b).is("input:radio")||a("[name="+a.jgrid.jqID(w)+"]",b).is("input:checkbox")?a("[name="+a.jgrid.jqID(w)+"]",b).each(function(){a(this).val()==q[w]?a(this)[e.p.useProp?"prop":"attr"]("checked",true):a(this)[e.p.useProp?"prop":"attr"]("checked",false)}):a("[name="+a.jgrid.jqID(w)+"]",b).val(q[w])}})},FormToGrid:function(f,b,e,q){return this.each(function(){var w=this;if(w.grid){e||(e="set");q||(q="first");
var H=a(b).serializeArray(),y={};a.each(H,function(z,m){y[m.name]=m.value});if(e=="add")a(w).jqGrid("addRowData",f,y,q);else e=="set"&&a(w).jqGrid("setRowData",f,y)}})}})})(jQuery);
