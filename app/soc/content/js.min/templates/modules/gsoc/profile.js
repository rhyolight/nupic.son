melange.templates.inherit(function(){function k(){jQuery.each(d,function(c,b){b.old_value=jQuery(b.id).val()})}function q(){var c=false;jQuery.each(d,function(b,a){if(jQuery(a.id).val()!==a.old_value){c=true;return false}});return c}function l(){jQuery(i).val(g);jQuery(j).val(h)}function r(){g=jQuery(i).val();h=jQuery(j).val()}function s(){if(q()){var c="";jQuery.each(d,function(b,a){c+=jQuery(a.id).val()+","});m.geocode({address:c},function(b,a){if(a===google.maps.GeocoderStatus.OK){b=b[0].geometry.location;
k();a=n;if(jQuery(d.street.id).val()!=="")a=o;else if(jQuery(d.city.id).val()!=="")a=t;else if(jQuery(d.state.id).val()!=="")a=u;else if(jQuery(d.country.id).val()!=="")a=v;e.setZoom(a);e.setCenter(b);f.setPosition(b);g=b.lat();h=b.lng();l()}})}}function w(){k();var c,b=n,a=true;c={mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:true,panControl:true,zoomControl:true};e=new google.maps.Map(jQuery("#"+p)[0],c);m=new google.maps.Geocoder;if(jQuery(i).val()!==""&&jQuery(j).val()!==""){r();b=o;
a=true}c=new google.maps.LatLng(g,h);e.setZoom(b);e.setCenter(c);f=new google.maps.Marker({position:c,draggable:true});a&&f.setMap(e);jQuery.each(d,function(y,x){jQuery(x.id).blur(s)});google.maps.event.addListener(f,"dragend",function(){g=f.getPosition().lat();h=f.getPosition().lng();l()})}var e,f,m,g=0,h=0,n=1,v=4,u=6,t=10,o=14,p="profile_map",i="#latitude",j="#longitude",d={street:{id:"#res_street",old_value:""},city:{id:"#res_city",old_value:""},state:{id:"#res_state",old_value:""},country:{id:"#res_country",
old_value:""},postalcode:{id:"#res_postalcode",old_value:""}};jQuery(function(){jQuery("#form_row_publish_location").append("<div id='"+p+"'></div>");melange.loadGoogleApi("maps","3",{other_params:"sensor=false"},w)})});
