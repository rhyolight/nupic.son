(function(){if(window.melange===undefined)throw new Error("Melange not loaded");var g=window.melange;if(window.melange.list===undefined)throw new Error("melange.list not loaded");if(window.jLinq===undefined)throw new Error("jLinq not loaded");var j=window.jLinq;g.list.cookie_service=window.melange.list.cookie_service=function(){return new g.list.cookie_service};var n=g.logging.debugDecorator(g.list.cookie_service),s=function(c){var a={hidden_columns:{}};jQuery.each(c,function(b,d){a.hidden_columns[d.name]=
d.hidden});return a},t=function(c,a){return{sort_settings:{sortname:c,sortorder:a}}},u=function(c,a){var b={filters:{}};a._search===true&&jQuery.each(c,function(d,f){if(a[f.name]!==undefined)b.filters[f.name]=a[f.name]});return b},v=function(c){var a={column_widths:{}};jQuery.each(c,function(b,d){if(d.width!==undefined)a.column_widths[d.name]=d.width});return a},w=function(c){var a={columns_order:{}},b=0;if(c[0].name==="cb")b=1;jQuery.each(c,function(d,f){if(f.name!=="cb")a.columns_order[f.name]=
d-b});return a};n.saveCurrentTableConfiguration=function(c,a,b){b=typeof b!=="undefined"?b:false;var d=g.cookie.getCookie(g.cookie.MELANGE_USER_PREFERENCES);if(d.lists_configuration[c]!==undefined&&d.lists_configuration[c].column_widths!==undefined)b=true;var f=a.jqGrid("getGridParam","colModel"),k=a.jqGrid("getGridParam","sortname"),l=a.jqGrid("getGridParam","sortorder"),i=a.jqGrid("getGridParam","postData");a=s(f);a=jQuery.extend(t(k,l),a);a=jQuery.extend(u(f,i),a);if(b===true)a=jQuery.extend(v(f),
a);a=jQuery.extend(w(f),a);b={lists_configuration:{}};b.lists_configuration[c]=a;b.lists_configuration=jQuery.extend(d.lists_configuration,b.lists_configuration);g.cookie.saveCookie(g.cookie.MELANGE_USER_PREFERENCES,b,14,window.location.pathname)};n.getPreviousTableConfiguration=function(c,a){var b=g.cookie.getCookie(g.cookie.MELANGE_USER_PREFERENCES),d=a.colModel,f=a.colNames;if(b.lists_configuration[c]!==undefined){jQuery.each(b.lists_configuration[c].hidden_columns,function(e,h){e=j.from(d).equals("name",
e).select()[0]||null;if(e!==null)e.hidden=h});if(b.lists_configuration[c].sort_settings!==undefined){var k=b.lists_configuration[c].sort_settings.sortname,l=b.lists_configuration[c].sort_settings.sortorder;if(j.from(d).equals("name",k).select()[0]!==undefined?true:false){a.sortname=k;a.sortorder=l}}b.lists_configuration[c].filters!==undefined&&jQuery.each(b.lists_configuration[c].filters,function(e,h){e=j.from(d).equals("name",e).select()[0];if(e!==undefined)e.searchoptions={defaultValue:h}});b.lists_configuration[c].column_widths!==
undefined&&jQuery.each(b.lists_configuration[c].column_widths,function(e,h){e=j.from(d).equals("name",e).select()[0];if(e!==undefined){a.shrinkToFit=false;e.width=h}});if(b.lists_configuration[c].columns_order!==undefined){var i=b.lists_configuration[c].columns_order,o=[],p=[],q=[],r=[];jQuery.each(d,function(e,h){var m=h.name;if(i[m]!==undefined){o[i[m]]=h;p[i[m]]=f[e]}else{q.push(h);r.push(f[e])}});a.colModel=jQuery.merge(o,q);a.colNames=jQuery.merge(p,r)}}return a}})();
