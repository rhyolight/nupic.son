(function(){if(window.melange===undefined)throw new Error("Melange not loaded");var f=window.melange;if(window.melange.list===undefined)throw new Error("melange.list not loaded");if(window.jLinq===undefined)throw new Error("jLinq not loaded");var i=window.jLinq;f.list.cookie_service=window.melange.list.cookie_service=function(){return new f.list.cookie_service};var k=f.logging.debugDecorator(f.list.cookie_service),l=function(c){var a={hidden_columns:{}};jQuery.each(c,function(b,d){a.hidden_columns[d.name]=
d.hidden});return a},m=function(c,a){return{sort_settings:{sortname:c,sortorder:a}}},n=function(c,a){var b={filters:{}};a._search===true&&jQuery.each(c,function(d,g){if(a[g.name]!==undefined)b.filters[g.name]=a[g.name]});return b},o=function(c){var a={column_widths:{}};jQuery.each(c,function(b,d){if(d.width!==undefined)a.column_widths[d.name]=d.width});return a};k.saveCurrentTableConfiguration=function(c,a,b){b=typeof b!=="undefined"?b:false;var d=f.cookie.getCookie(f.cookie.MELANGE_USER_PREFERENCES);
if(d.lists_configuration[c]!==undefined&&d.lists_configuration[c].column_widths!==undefined)b=true;var g=a.jqGrid("getGridParam","colModel"),j=a.jqGrid("getGridParam","sortname"),e=a.jqGrid("getGridParam","sortorder"),h=a.jqGrid("getGridParam","postData");a=l(g);a=jQuery.extend(m(j,e),a);a=jQuery.extend(n(g,h),a);if(b===true)a=jQuery.extend(o(g),a);b={lists_configuration:{}};b.lists_configuration[c]=a;b.lists_configuration=jQuery.extend(d.lists_configuration,b.lists_configuration);f.cookie.saveCookie(f.cookie.MELANGE_USER_PREFERENCES,
b,14,window.location.pathname)};k.getPreviousTableConfiguration=function(c,a){var b=f.cookie.getCookie(f.cookie.MELANGE_USER_PREFERENCES),d=a.colModel;if(b.lists_configuration[c]!==undefined){jQuery.each(b.lists_configuration[c].hidden_columns,function(e,h){e=i.from(d).equals("name",e).select()[0]||null;if(e!==null)e.hidden=h});if(b.lists_configuration[c].sort_settings!==undefined){var g=b.lists_configuration[c].sort_settings.sortname,j=b.lists_configuration[c].sort_settings.sortorder;if(i.from(d).equals("name",
g).select()[0]!==undefined?true:false){a.sortname=g;a.sortorder=j}}b.lists_configuration[c].filters!==undefined&&jQuery.each(b.lists_configuration[c].filters,function(e,h){e=i.from(d).equals("name",e).select()[0];if(e!==undefined)e.searchoptions={defaultValue:h}});b.lists_configuration[c].column_widths!==undefined&&jQuery.each(b.lists_configuration[c].column_widths,function(e,h){e=i.from(d).equals("name",e).select()[0];if(e!==undefined){a.shrinkToFit=false;e.width=h}})}return a}})();
